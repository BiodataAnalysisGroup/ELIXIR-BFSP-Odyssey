# Contributing to Odyssey

Hi there! Many thanks for taking an interest in improving `Odyssey`.
This document outlines how to propose any changes to `Odyssey`.

## Contributions

### Getting familiar with Git and GitHub

> **What is Git?**
>
> Git is a version control system that tracks changes to files over
> time, allowing multiple people to collaborate on a project safely.
>
> **What is GitHub?**
>
> GitHub is an online platform for hosting Git repositories and
> collaborating with others through pull requests, issues, and
> discussions.
>
> **Essential Concepts** - *Repository (repo)*: The projectâ€™s folder on
> GitHub. - *Fork*: Your own copy of the repository, where you can make
> changes freely. - *Branch*: A workspace for your changes (avoid
> working directly on main). - *Commit*: A saved change with a message
> describing what you did. - *Pull Request (PR)*: A request to merge
> your changes into the main project.

1.  Create a [GitHub](https://github.com/) account if you donâ€™t already
    have one.
2.  Install [Git](https://git-scm.com/) on your computer.
3.  Configure Git with your information (in your terminal, powershell,
    etc.):

``` sh
git config --global user.name  "Your Name"
git config --global user.email "your.email@example.com"
```

### GitHub issues

- If you encounter a bug in the app, please open an issue using the Bug
  Report template.
- For new feature suggestions (i.e., suggestions for improving the app,
  ??), use the Feature Request template.
- For all other matters, feel free to open an issue using the Blank
  template.

Once the issue is created, you can assign a reviewer yourself or leave
it unassigned â€” a team member will review it and take it from there.

### Pull Request workflow

If youâ€™d like to write some code for `Odyssey`, the standard workflow is
as follows:

1.  Check that there isnâ€™t already an issue about your idea in the
    `Odyssey` issues to avoid duplicating work. If there isnâ€™t one
    already, please create one so that others know youâ€™re working on
    this.
2.  Fork the **`Odyssey` dev branch** to your GitHub account
3.  Clone your fork of this repository

``` sh
git clone https://github.com/<your-username>/<repo-name>.git
```

4.  Create a new branch for your changes (relevant to an issue?)

``` sh
git checkout -b your-feature-name
```

5.  Make the necessary changes / additions within your forked
    repository.
6.  Submit a Pull Request against the dev branch and wait for the code
    to be reviewed and merged.

### R Shiny package (within R Studio)

1.  From within your project folder, install all development
    dependencies:

``` r
devtools::install_dev_deps()
```

2.  Ensure that everything builds and passes checks cleanly

``` r
devtools::check()
```

3.  Implement your changes, and then run

``` r
devtools::load_all()

run_odyssey()
```

4.  Again make sure that everything builds and passes checks cleanly

``` r
devtools::check()
```

5.  When you are ready commit and push your changes

### Modularized R Shiny Package

This project follows a modular Shiny structure: each feature is a
self-contained module with its own UI, server logic, inputs/outputs, and
tests. Modules make the app easier to understand, test, and extend
without breaking unrelated parts.

#### Folder layout

``` sh
â”œâ”€ R/
â”‚  â”œâ”€ app_ui.R               # top-level UI (calls module UIs)
â”‚  â”œâ”€ app_server.R           # top-level server (calls module servers)
â”‚  â”œâ”€ mod_<feature>.R        # one file per module (UI + server)
â”‚  â”œâ”€ utils-*.R              # shared helpers (pure functions)
â”‚  â””â”€ globals.R              # (optional) constants
â”œâ”€ inst/
â”‚  â”œâ”€ app/www/               # CSS/JS/images
â”‚  â””â”€ templates/             # (optional) downloads, reports
â”œâ”€ tests/
â”‚  â”œâ”€ testthat/              # unit tests & shinytests
â”‚  â””â”€ testthat.R
â”œâ”€ DESCRIPTION               # package metadata & deps
â”œâ”€ NAMESPACE                 # generated by roxygen2
â”œâ”€ NEWS.md                   # changelog (user-facing)
â””â”€ README.md
```

#### Module pattern

Each module file exports two functions

``` sh
# R/mod_example.R
#' example UI
example_ui <- function(id) {
  ns <- NS(id)
  tagList(
    sidebarLayout(
      sidebarPanel(
        textInput(ns("name"), "Your name"),
        actionButton(ns("go"), "Greet")
      ),
      mainPanel(
        textOutput(ns("greeting"))
      )
    )
  )
}

#' example server
example_server <- function(id) {
  moduleServer(id, function(input, output, session) {
    greeting <- eventReactive(input$go, {
      paste("Hello,", input$name %||% "friend", "ðŸ‘‹")
    })
    output$greeting <- renderText(greeting())
    # (Optional) return reactive(s) for other modules to consume:
    return(list(greeting = greeting))
  })
}
```

- Use `NS(id)` for namespacing all input/output IDs.
- Keep business logic in pure helper functions in R/utils-\*.R so
  theyâ€™re testable.
- Return reactives only when other modules truly need them (avoid global
  state).

### Unit testing

We use [testthat](https://cran.r-project.org/package=testthat) for unit
tests. Contributions with test cases are very welcome!

### Fixing typos

You can fix typos, spelling mistakes, or grammatical errors in the
documentation directly using the GitHub web interface, as long as the
changes are made in the *source* file. This generally means youâ€™ll need
to edit [roxygen2
comments](https://roxygen2.r-lib.org/articles/roxygen2.html) in an `.R`
file.

### Other

- If you want to make a bigger change \[such asâ€¦\], itâ€™s a good idea to
  first file an issue and make sure someone from the team agrees that
  itâ€™s needed.
- If youâ€™ve found a bug, please file an issue that illustrates the bug
  with a minimal [reprex](https://www.tidyverse.org/help/#reprex) (this
  will also help you write a unit test, if needed).

## Code style

- New code should follow the tidyverse [style
  guide](https://style.tidyverse.org). You can use the
  [styler](https://CRAN.R-project.org/package=styler) package to apply
  these styles, but please donâ€™t restyle code that has nothing to do
  with your PR.  
- We use [roxygen2](https://cran.r-project.org/package=roxygen2), with
  [Markdown
  syntax](https://roxygen2.r-lib.org/articles/rd-formatting.html), for
  documentation.

## Code of Conduct

Please note that the tidyverse project is released with a [Contributor
Code of
Conduct](https://biodataanalysisgroup.github.io/ELIXIR-BFSP-Odyssey/CODE_OF_CONDUCT.md).
By contributing to this project you agree to abide by its terms.

## Resources

- [R Packages (2e)](https://r-pkgs.org/)
- [Mastering Shiny](https://mastering-shiny.org/)
- [Modularizing Shiny app
  code](https://shiny.posit.co/r/articles/improve/modules/)
